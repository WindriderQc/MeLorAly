<!-- Parental Dashboard -->
<div class="min-h-screen bg-background-light pb-24">
    <!-- Hero/Welcome Section -->
    <div class="bg-gradient-to-br from-primary to-pink-400 text-white px-6 py-8 rounded-b-3xl shadow-lg">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center gap-4 mb-4">
                <% if (profile && profile.avatar_url) { %>
                    <img src="<%= profile.avatar_url %>" alt="Avatar" class="w-16 h-16 rounded-full border-4 border-white shadow-lg">
                <% } else { %>
                    <div class="w-16 h-16 bg-white/20 rounded-full flex items-center justify-center border-4 border-white shadow-lg">
                        <span class="material-symbols-outlined text-white text-3xl filled">person</span>
                    </div>
                <% } %>
                <div>
                    <h1 class="text-2xl font-black">
                        Bonjour, <%= profile ? profile.first_name : 'Bienvenue' %>! üëã
                    </h1>
                    <p class="text-white/90">Voici un aper√ßu de votre famille</p>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-6 py-6">
        <!-- Quick Stats -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 -mt-8">
            <div class="bg-white rounded-2xl shadow-lg p-4 text-center">
                <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-2">
                    <span class="material-symbols-outlined text-blue-600 filled">group</span>
                </div>
                <div class="text-2xl font-bold text-gray-900"><%= families.length %></div>
                <div class="text-xs text-gray-500">Familles</div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-4 text-center">
                <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-2">
                    <span class="material-symbols-outlined text-green-600 filled">child_care</span>
                </div>
                <div class="text-2xl font-bold text-gray-900"><%= children.length %></div>
                <div class="text-xs text-gray-500">Enfants</div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-4 text-center">
                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-2">
                    <span class="material-symbols-outlined text-purple-600 filled">chat</span>
                </div>
                <div class="text-2xl font-bold text-gray-900"><%= notifications.filter(n => !n.read).length %></div>
                <div class="text-xs text-gray-500">Messages</div>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-4 text-center">
                <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center mx-auto mb-2">
                    <span class="material-symbols-outlined text-primary filled">event</span>
                </div>
                <div class="text-2xl font-bold text-gray-900">0</div>
                <div class="text-xs text-gray-500">√âv√©nements</div>
            </div>
        </div>

        <div class="grid lg:grid-cols-3 gap-6">
            <!-- Main Content -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Families Section -->
                <div>
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                            <span class="material-symbols-outlined text-primary filled">home</span>
                            Mes familles
                        </h2>
                        <a href="/family/create" class="bg-primary text-gray-900 px-4 py-2 rounded-full text-sm font-bold hover:shadow-lg transition">
                            <span class="material-symbols-outlined text-sm align-middle">add</span>
                            Cr√©er
                        </a>
                    </div>

                    <% if (families.length === 0) { %>
                        <div class="bg-white rounded-2xl shadow-sm p-8 text-center">
                            <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="material-symbols-outlined text-gray-400 text-4xl">home</span>
                            </div>
                            <h3 class="text-lg font-bold text-gray-900 mb-2">Aucune famille configur√©e</h3>
                            <p class="text-gray-600 mb-4">Commencez par cr√©er votre premi√®re famille pour inviter vos proches.</p>
                            <a href="/family/create" class="inline-block bg-primary text-gray-900 px-6 py-3 rounded-full font-bold hover:shadow-lg transition">
                                <span class="material-symbols-outlined text-sm align-middle">add</span>
                                Cr√©er ma premi√®re famille
                            </a>
                        </div>
                    <% } else { %>
                        <div class="grid md:grid-cols-2 gap-4">
                            <% families.forEach(familyMember => { %>
                                <div class="bg-white rounded-2xl shadow-sm p-5 hover:shadow-lg transition">
                                    <div class="flex items-center gap-3 mb-4">
                                        <% if (familyMember.families.avatar_url) { %>
                                            <img src="<%= familyMember.families.avatar_url %>" alt="Avatar famille" class="w-14 h-14 rounded-2xl object-cover">
                                        <% } else { %>
                                            <div class="w-14 h-14 bg-gradient-to-br from-primary to-pink-400 rounded-2xl flex items-center justify-center">
                                                <span class="material-symbols-outlined text-white text-2xl filled">group</span>
                                            </div>
                                        <% } %>
                                        <div class="flex-grow">
                                            <h3 class="font-bold text-gray-900"><%= familyMember.families.name %></h3>
                                            <p class="text-sm text-gray-500 capitalize">
                                                <span class="material-symbols-outlined text-xs align-middle">badge</span>
                                                <%= familyMember.role %>
                                            </p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex gap-2">
                                        <a href="/family/<%= familyMember.families.id %>" 
                                            class="flex-1 bg-primary/10 text-primary px-4 py-2 rounded-xl text-sm font-bold text-center hover:bg-primary/20 transition">
                                            Voir
                                        </a>
                                        <a href="/messages?family=<%= familyMember.families.id %>" 
                                            class="flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-xl text-sm font-bold text-center hover:bg-gray-200 transition">
                                            Messages
                                        </a>
                                        <% if (familyMember.role === 'admin') { %>
                                            <a href="/family/<%= familyMember.families.id %>/manage" 
                                               class="w-10 h-10 bg-orange-100 text-orange-600 rounded-xl flex items-center justify-center hover:bg-orange-200 transition"
                                               title="G√©rer la famille">
                                                <span class="material-symbols-outlined text-sm">settings</span>
                                            </a>
                                        <% } %>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                    <% } %>
                </div>

                <!-- Children Section -->
                <% if (children.length > 0) { %>
                    <div>
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold text-gray-900 flex items-center gap-2">
                                <span class="material-symbols-outlined text-green-600 filled">child_care</span>
                                Mes enfants
                            </h2>
                            <a href="/children/add" class="bg-green-500 text-white px-4 py-2 rounded-full text-sm font-bold hover:shadow-lg transition">
                                <span class="material-symbols-outlined text-sm align-middle">add</span>
                                Ajouter
                            </a>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                            <% children.forEach(child => { %>
                                <div class="bg-white rounded-2xl shadow-sm p-4 text-center hover:shadow-lg transition">
                                    <% if (child.avatar_url) { %>
                                        <img src="<%= child.avatar_url %>" alt="<%= child.name %>" class="w-16 h-16 rounded-full mx-auto mb-3 object-cover">
                                    <% } else { %>
                                        <div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                            <span class="material-symbols-outlined text-white text-2xl filled">child_care</span>
                                        </div>
                                    <% } %>
                                    <h3 class="font-bold text-gray-900 text-sm"><%= child.name %></h3>
                                    <% if (child.grade) { %>
                                        <p class="text-xs text-gray-500"><%= child.grade %></p>
                                    <% } %>
                                </div>
                            <% }); %>
                        </div>
                    </div>
                <% } %>

                <!-- Education Resources -->
                <div class="bg-gradient-to-br from-green-50 to-blue-50 rounded-2xl p-6">
                    <div class="flex items-start gap-4">
                        <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center flex-shrink-0">
                            <span class="material-symbols-outlined text-white filled">school</span>
                        </div>
                        <div class="flex-grow">
                            <h3 class="font-bold text-gray-900 mb-2">Ressources √©ducatives</h3>
                            <p class="text-sm text-gray-600 mb-3">D√©couvrez des activit√©s adapt√©es √† l'√¢ge de vos enfants</p>
                            <a href="/education" class="inline-block bg-green-500 text-white px-4 py-2 rounded-full text-sm font-bold hover:shadow-lg transition">
                                Explorer
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
                <!-- Quick Actions -->
                <div class="bg-white rounded-2xl shadow-sm p-5">
                    <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary filled">bolt</span>
                        Actions rapides
                    </h3>
                    <div class="space-y-2">
                        <a href="/family/invite" class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 transition group">
                            <div class="w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center group-hover:bg-primary/20 transition">
                                <span class="material-symbols-outlined text-primary">person_add</span>
                            </div>
                            <div class="flex-grow">
                                <div class="text-sm font-bold text-gray-900">Inviter un membre</div>
                                <div class="text-xs text-gray-500">Agrandir la famille</div>
                            </div>
                        </a>
                        
                        <a href="/children/add" class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 transition group">
                            <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center group-hover:bg-green-200 transition">
                                <span class="material-symbols-outlined text-green-600">child_care</span>
                            </div>
                            <div class="flex-grow">
                                <div class="text-sm font-bold text-gray-900">Ajouter un enfant</div>
                                <div class="text-xs text-gray-500">Nouveau profil</div>
                            </div>
                        </a>
                        
                        <a href="/messages" class="flex items-center gap-3 p-3 rounded-xl hover:bg-gray-50 transition group">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition">
                                <span class="material-symbols-outlined text-blue-600">chat</span>
                            </div>
                            <div class="flex-grow">
                                <div class="text-sm font-bold text-gray-900">Voir les messages</div>
                                <div class="text-xs text-gray-500">Messagerie</div>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Recent Notifications -->
                <div class="bg-white rounded-2xl shadow-sm p-5">
                    <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <span class="material-symbols-outlined text-purple-600 filled">notifications</span>
                        Notifications
                    </h3>
                    
                    <% if (notifications.length === 0) { %>
                        <div class="text-center py-6">
                            <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="material-symbols-outlined text-gray-400 text-3xl">notifications_off</span>
                            </div>
                            <p class="text-sm text-gray-500">Aucune notification</p>
                        </div>
                    <% } else { %>
                        <div class="space-y-3">
                            <% notifications.slice(0, 5).forEach(notification => { %>
                                <div class="flex gap-3 p-3 rounded-xl <%= !notification.read ? 'bg-primary/5' : 'bg-gray-50' %>">
                                    <div class="w-2 h-2 bg-primary rounded-full mt-2 flex-shrink-0 <%= notification.read ? 'opacity-0' : '' %>"></div>
                                    <div class="flex-grow min-w-0">
                                        <h4 class="text-sm font-bold text-gray-900 mb-1 truncate"><%= notification.title %></h4>
                                        <% if (notification.message) { %>
                                            <p class="text-xs text-gray-600 mb-1 line-clamp-2"><%= notification.message %></p>
                                        <% } %>
                                        <p class="text-xs text-gray-400">
                                            <%= new Date(notification.created_at).toLocaleDateString('fr-FR') %>
                                        </p>
                                    </div>
                                </div>
                            <% }); %>
                        </div>
                        
                        <a href="/notifications" class="block mt-4 text-center text-sm font-bold text-primary hover:text-primary/80 transition">
                            Voir tout
                        </a>
                    <% } %>
                </div>

                <!-- Tips Card -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-5">
                    <div class="flex items-start gap-3 mb-3">
                        <div class="w-10 h-10 bg-purple-500 rounded-xl flex items-center justify-center flex-shrink-0">
                            <span class="material-symbols-outlined text-white filled">tips_and_updates</span>
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-900 mb-1">Astuce du jour</h3>
                            <p class="text-sm text-gray-600">
                                Invitez les grands-parents pour qu'ils suivent les progr√®s de vos enfants!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>